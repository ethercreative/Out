{"version":3,"file":"out.min.js","sources":["../../../resources/js/out.js"],"sourcesContent":["/** global: Craft, Garnish, $ */\nconst prevLoad = window.onload;\n\nwindow.onload = function () {\n\tprevLoad && prevLoad();\n\n\tconst elementType = document.getElementById(\"elementType\");\n\n\tconst typeSource = document.querySelectorAll(\"[data-source-type]\");\n\tconst sourcesByType = {};\n\n\tfor (let i = 0, l = typeSource.length; i < l; ++i) {\n\t\tconst f = typeSource[i];\n\t\tconst t = f.dataset.sourceType;\n\n\t\tconst comment = document.createComment(t)\n\t\t\t, input   = f;\n\n\t\tinput.removeAttribute(\"style\");\n\n\t\tsourcesByType[t] = { comment, input };\n\n\t\tif (elementType.value !== t)\n\t\t\tinput.parentNode.replaceChild(comment, input);\n\t}\n\n\tlet currentActive = sourcesByType[elementType.value];\n\n\telementType.addEventListener(\"change\", e => {\n\t\tcurrentActive.input.parentNode.replaceChild(\n\t\t\tcurrentActive.comment,\n\t\t\tcurrentActive.input\n\t\t);\n\n\t\tcurrentActive = sourcesByType[e.target.value];\n\n\t\tcurrentActive.comment.parentNode.replaceChild(\n\t\t\tcurrentActive.input,\n\t\t\tcurrentActive.comment\n\t\t);\n\t});\n};\n\n{\n\tconst h = function (tag = \"div\", attributes = {}, children = []) {\n\t\tconst elem = document.createElement(tag);\n\n\t\tfor (let [key, value] of Object.entries(attributes)) {\n\t\t\tif (!value) continue;\n\n\t\t\tif (typeof value === \"function\") {\n\t\t\t\tif (key === \"ref\") value(elem);\n\t\t\t\telse elem.addEventListener(key, value);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (key === \"style\")\n\t\t\t\tvalue = value.replace(/[\\t\\r\\n]/g, \" \").trim();\n\n\t\t\telem.setAttribute(key, value);\n\t\t}\n\n\t\tif (!Array.isArray(children))\n\t\t\tchildren = [children];\n\n\t\tchildren.forEach(child => {\n\t\t\tif (!child) return;\n\n\t\t\ttry {\n\t\t\t\telem.appendChild(child);\n\t\t\t} catch (_) {\n\t\t\t\telem.appendChild(document.createTextNode(child));\n\t\t\t}\n\t\t});\n\n\t\treturn elem;\n\t};\n\tconst f = function (config) {\n\t\treturn h(\"div\", { class: \"field\" }, [\n\t\t\th(\"div\", { class: \"heading\" }, [\n\t\t\t\th(\"label\", { for: config.id }, config.label),\n\t\t\t\tconfig.hasOwnProperty(\"instructions\")\n\t\t\t\t\t? h(\"div\", { class: \"instructions\" }, h(\"p\", {}, config.instructions))\n\t\t\t\t\t: null\n\t\t\t]),\n\t\t\th(\"div\", { class: \"input\" }, [\n\t\t\t\th(config.tag, { id: config.id, ...config.attr }, config.children || null)\n\t\t\t]),\n\t\t]);\n\t};\n\n\twindow.Out = {\n\n\t\t// Properties\n\t\t// =====================================================================\n\n\t\tfieldMap: {},\n\t\tfields: {},\n\t\tactiveFieldId: null,\n\n\t\tmodal: null,\n\n\t\theadingInput: null,\n\t\ttwigInput: null,\n\t\tescapeInput: null,\n\n\t\tfieldSettings: null,\n\n\t\t// Functions\n\t\t// =====================================================================\n\n\t\tinit (fieldMap) {\n\t\t\tthis.fieldMap = fieldMap;\n\n\t\t\tthis.fieldSettings = document.getElementById(\"fieldSettings\");\n\t\t\tthis.fields = JSON.parse(JSON.parse(this.fieldSettings.value));\n\t\t\tif (Array.isArray(this.fields)) this.fields = {};\n\n\t\t\tthis.modal = new Garnish.Modal(\n\t\t\t\th(\"div\", { class: \"modal out--modal\" }, [\n\t\t\t\t\th(\"div\", { class: \"body\" }, [\n\t\t\t\t\t\tf({\n\t\t\t\t\t\t\tlabel: \"Column Heading\",\n\t\t\t\t\t\t\tid: \"out_columnHeading\",\n\t\t\t\t\t\t\ttag: \"input\",\n\t\t\t\t\t\t\tattr: {\n\t\t\t\t\t\t\t\tclass: \"text fullwidth\",\n\t\t\t\t\t\t\t\tref: el => { this.headingInput = el; }\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tf({\n\t\t\t\t\t\t\tlabel: \"Twig\",\n\t\t\t\t\t\t\tid: \"out_twig\",\n\t\t\t\t\t\t\ttag: \"textarea\",\n\t\t\t\t\t\t\tattr: {\n\t\t\t\t\t\t\t\trows: 5,\n\t\t\t\t\t\t\t\tclass: \"text fullwidth\",\n\t\t\t\t\t\t\t\tref: el => { this.twigInput = el; }\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tinstructions: [\n\t\t\t\t\t\t\t\t\"Code to be executed in place of the fields output. You have access to the \",\n\t\t\t\t\t\t\t\th(\"code\", {}, \"element\"),\n\t\t\t\t\t\t\t\t\" variable as well as all global & Craft variables.\",\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tf({\n\t\t\t\t\t\t\tlabel: \"Escape Value\",\n\t\t\t\t\t\t\tid: \"out_escape\",\n\t\t\t\t\t\t\ttag: \"input\",\n\t\t\t\t\t\t\tattr: {\n\t\t\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\t\t\tchecked: true,\n\t\t\t\t\t\t\t\tref: el => { this.escapeInput = el; }\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tinstructions: \"If checked the output of the column will be escaped\",\n\t\t\t\t\t\t})\n\t\t\t\t\t]),\n\t\t\t\t\th(\"div\", { class: \"footer\" }, [\n\t\t\t\t\t\th(\"div\", { class: \"buttons right\" }, [\n\t\t\t\t\t\t\th(\"button\", {\n\t\t\t\t\t\t\t\tclass: \"btn\",\n\t\t\t\t\t\t\t\tclick: this.cancel.bind(this),\n\t\t\t\t\t\t\t}, \"Cancel\"),\n\t\t\t\t\t\t\th(\"button\", {\n\t\t\t\t\t\t\t\tclass: \"btn submit\",\n\t\t\t\t\t\t\t\tclick: this.update.bind(this),\n\t\t\t\t\t\t\t}, \"Update\"),\n\t\t\t\t\t\t]),\n\t\t\t\t\t]),\n\t\t\t\t]),\n\t\t\t\t{ autoShow: false }\n\t\t\t);\n\t\t},\n\n\t\tedit (field) {\n\t\t\tthis.setValues(field);\n\t\t\tthis.modal.show();\n\t\t},\n\n\t\t// Actions\n\t\t// =====================================================================\n\n\t\tsetValues (field) {\n\t\t\tconst fieldId = field.dataset.id;\n\n\t\t\tthis.activeFieldId = fieldId;\n\n\t\t\tif (this.fields.hasOwnProperty(fieldId)) {\n\t\t\t\tconst p = this.fields[fieldId];\n\n\t\t\t\tthis.headingInput.value = p.heading;\n\t\t\t\tthis.twigInput.value = p.twig;\n\t\t\t\tthis.escapeInput.checked = p.escape;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.headingInput.value = field.textContent.trim();\n\t\t\tthis.twigInput.value = `{{ element.${this.fieldMap[fieldId]} }}`;\n\t\t},\n\n\t\tupdate () {\n\t\t\tthis.fields[this.activeFieldId] = {\n\t\t\t\theading: this.headingInput.value,\n\t\t\t\ttwig: this.twigInput.value,\n\t\t\t\tescape: this.escapeInput.checked,\n\t\t\t};\n\n\t\t\tthis.fieldSettings.value = JSON.stringify(this.fields);\n\n\t\t\tthis.modal.hide();\n\t\t},\n\n\t\tcancel () {\n\t\t\tthis.modal.hide();\n\t\t},\n\n\t};\n}"],"names":["prevLoad","window","onload","elementType","document","getElementById","typeSource","querySelectorAll","sourcesByType","i","l","length","f","t","dataset","sourceType","comment","createComment","input","removeAttribute","value","parentNode","replaceChild","currentActive","addEventListener","e","target","h","tag","attributes","children","elem","createElement","Object","entries","key","replace","trim","setAttribute","Array","isArray","forEach","child","appendChild","_","createTextNode","config","class","for","id","label","hasOwnProperty","instructions","attr","Out","fieldMap","fieldSettings","fields","JSON","parse","this","modal","Garnish","Modal","headingInput","el","twigInput","escapeInput","cancel","bind","update","autoShow","field","setValues","show","fieldId","activeFieldId","p","heading","twig","checked","escape","textContent","stringify","hide"],"mappings":"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"}